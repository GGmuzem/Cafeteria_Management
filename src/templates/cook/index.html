<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Панель повара</title>
</head>
<body>

<h1>Вы авторизовались как повар</h1>

<hr>
<h2>Добавить блюдо в меню</h2>
<form method="post">
    <input type="hidden" name="action" value="add_menu">

    <label>Название блюда:</label><br>
    <input type="text" name="name" required><br><br>

    <label>Цена:</label><br>
    <input type="number" name="price" required><br><br>

    <label>Состав:</label><br>
    <textarea name="composition" rows="4" cols="50" required>
    </textarea><br><br>

    <label>Вес (г):</label><br>
    <input type="number" name="weight" min="1">

    <button type="submit">Добавить блюдо</button>
</form>


<hr>
<h2>Текущее меню</h2>
<ul>


    
{% for m in menu %}
    <li>
        <b>{{ m.name }}</b> {% if m.weight %}({{ m.weight }} г){% endif %} — {{ m.price }} руб.<br>
        Состав: {{ m.composition }}
        {% if edit_menu %}
        <form method="post">
            <input type="hidden" name="action" value="save_menu">
            <input type="hidden" name="menu_id" value="{{ edit_menu.id }}">

            <input name="name" value="{{ edit_menu.name }}">
            <input name="price" value="{{ edit_menu.price }}">
            <input name="composition" value="{{ edit_menu.composition }}">
            <input type="number" name="weight" min="1" step="1" value="{{ m.weight if m.weight else '' }}" placeholder="вес в г">

            <button type="submit">Сохранить</button>
        </form>
        {% else %}
        <form method="post" style="display:inline">
            <input type="hidden" name="action" value="start_edit_menu">
            <input type="hidden" name="menu_id" value="{{ m.id }}">
            <button type="submit">Изменить</button>
        </form>

        <form method="post" style="display:inline">
            <input type="hidden" name="action" value="delete_menu">
            <input type="hidden" name="menu_id" value="{{ m.id }}">
            <button type="submit">Удалить</button>
        </form>
        {% endif %}
    </li>
{% endfor %}
</ul>


<hr>
<h2>Склад</h2>
{% if storage %}
    <ul>
        {% for item in storage %}
            <li>{{ item.name }} — {{ item.amount }}</li>
        {% endfor %}
    </ul>
{% else %}
    <p>Склад пуст.</p>
{% endif %}


<hr>
<h2>Создать заявку на пополнение</h2>
<form method="post">
    <input type="hidden" name="action" value="create_request">
    <label>Продукт:</label><br>
    <input type="text" name="product" required><br><br>
    <label>Количество:</label><br>
    <input type="number" name="amount" required><br><br>
    <button type="submit">Отправить заявку</button>
</form>


<!-- <hr>
<h2>История</h2>
{% if history %}
    <table border="1" cellpadding="5">
        <tr>
            <th>Дата</th>
            <th>Тип</th>
            <th>Сумма / Кол-во</th>
        </tr>

        {% for h in history %}
        <tr>
            <td>{{ h.date }}</td>
            <td>{{ h.type_of_transaction }}</td>
            <td>{{ h.amount }}</td>
        </tr>
        {% endfor %}
    </table>
{% else %}
    <p>История пуста.</p>
{% endif %} -->

<h3>Текущие заявки</h3>
{% if my_requests %}
<table border="1" cellpadding="5">
  <tr><th>Продукт</th><th>Количество</th><th>Статус</th><th>Дата подачи</th></tr>
  {% for req in my_requests %}
  <tr>
    <td>{{ req.product }}</td>
    <td>{{ req.amount }}</td>
    <td>
      {% if req.status == 'pending' %}
        <span style="color: orange;">Ожидание</span>
      {% elif req.status == 'approved' %}
        <span style="color: green;">Одобрено</span>
      {% elif req.status == 'rejected' %}
        <span style="color: red;">Отклонено</span>
      {% endif %}
    </td>
    <td>{{ req.date.strftime('%d.%m.%Y %H:%M') }}</td>
  </tr>
  {% endfor %}
</table>
{% else %}
<p>Заявок пока нет.</p>
{% endif %}

<hr>
<a href="/logout">Выйти</a>

</body>
</html>
