<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–µ–Ω—é —Å—Ç–æ–ª–æ–≤–æ–π</title>
</head>
<body>
    <h1>–ù–∞—à–µ –ú–µ–Ω—é</h1>
    
    {% if current_user.role in ['cook', 'admin'] %}
    <div style="margin-bottom: 15px;">
        <a href="/cook" style="padding: 10px; background-color: #007bff; color: white; text-decoration: none; border-radius: 5px;">üë®‚Äçüç≥ –ü–∞–Ω–µ–ª—å –ø–æ–≤–∞—Ä–∞</a>
    </div>
    {% endif %}
    
    <!-- –§–æ—Ä–º–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ -->
    <div style="margin-bottom: 20px; padding: 10px; background-color: #f9f9f9; border: 1px solid #ddd;">
        <form action="/menu" method="get">
            <label for="allergen">–ò—Å–∫–ª—é—á–∏—Ç—å –∞–ª–ª–µ—Ä–≥–µ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ª—É–∫):</label>
            <input type="text" id="allergen" name="allergen" value="{{ request.args.get('allergen', '') }}" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç">
            <button type="submit">–ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä</button>
            <a href="/menu" style="margin-left: 10px;">–°–±—Ä–æ—Å–∏—Ç—å</a>
        </form>
    </div>

    <div class="menu-container">
        {% for item in menu_items %}
            <div class="menu-item" style="border: 1px solid #ccc; margin: 10px; padding: 10px;">
                <h3>{{ item.name }}</h3>
                
                <p>–°–æ—Å—Ç–∞–≤: 
                    {% if item.composition is mapping %}
                        {{ item.composition.get('ingredients', []) | join(', ') }}
                    {% else %}
                        {{ item.composition }}
                    {% endif %}
                </p>
                
                {% if item.composition is mapping and item.composition.get('weight') %}
                    <p>–í–µ—Å: {{ item.composition.weight }} –≥.</p>
                {% endif %}
                
                <p><strong>–¶–µ–Ω–∞:</strong> {{ item.price }} —Ä—É–±.</p>

                {% if current_user.role in ['cook', 'admin'] %}
                    <hr>
                    <a href="/cook/edit_menu/{{ item.id }}">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a> | 
                    <a href="/cook/delete_menu/{{ item.id }}" onclick="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã?');" style="color: red;">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</a>
                {% endif %}
            </div>
        {% else %}
            <p>–ú–µ–Ω—é –ø–æ–∫–∞ –ø—É—Å—Ç–æ.</p>
        {% endfor %}
    </div>
    <a href="/account">–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –ø—Ä–æ—Ñ–∏–ª—å</a>
</body>
</html>
